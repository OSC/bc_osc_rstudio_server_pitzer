<%-
  ppn   = num_cores.blank? ? 40 : num_cores.to_i
  props = case node_type
          when "hugemem"
            ":ppn=80"
          when "gpu"
            ":ppn=#{ppn}:gpus=1"
          else
            ":ppn=#{ppn}"
          end
-%>
---
batch_connect:
  template: "basic"
script:
  <%- if node_type == "debug" -%>
  queue_name: "debug"
  <%- end -%>
  native:
    resources:
      nodes: "1<%= props %>"
    <%-
      # Failing to request memory causes submission to fail on Pitzer
      if node_type == 'hugemem'
    -%>
      mem: 3000GB
    <%- end -%>
